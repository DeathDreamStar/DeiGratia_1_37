#################################################
# Flavor Events for Saxony
#
# Scripted by Sara Wendel-Örtqvist (flavor_sax.1)
# And Pierre du Plessis (the rest)
#################################################

namespace = flavor_sax
normal_or_historical_nations = yes

# Johann Sebastian Bach
country_event = {
	id = flavor_sax.1
	title = "flavor_sax.EVTNAME1"
	desc = "flavor_sax.EVTDESC1"
	picture = IMPORTANT_STATUE_eventPicture
	
	fire_only_once = yes
	
	trigger = {
		tag = SAX
		is_year = 1700
		NOT = { is_year = 1750 }
	}
	
	mean_time_to_happen = {
		months = 200
	}
	
	option = {
		name = "flavor_sax.EVTOPTA1"
		add_adm_power = 10
		add_prestige = 10
		add_innovativeness_small_effect = yes
	}
}

#Leipzig Prospers
province_event = {
	id = flavor_sax.3
	title = flavor_sax.3.name
	desc = flavor_sax.3.desc
	picture = INVENTION_eventPicture

	is_triggered_only = yes

	option = {
		name = flavor_sax.3.A
		if = {
			limit = { NOT = { trade_goods = coal } }
			change_trade_goods = paper
		}
		add_province_modifier = {
			name = encouraged_growth_tax
			duration = 18250
		}
		add_province_modifier = {
			name = encouraged_growth_production
			duration = 18250
		}
	}
}


#The Saxon Fratricidal War
country_event = {
	id = flavor_sax.4
	title = ipe_flavor_sax.4.t
	desc = ipe_flavor_sax.4.d
	picture = BAD_WITH_MONARCH_eventPicture

	fire_only_once = yes

	mean_time_to_happen = {
		months = 18
	}

	trigger = {
		tag = SAX
		NOT = {
			exists = THU
		}
		is_at_war = no
		dynasty = "von Wettin"
		any_owned_province = {
			is_core = THU
			NOT = {
				is_core = MEI
			}
		}
		any_owned_province = {
			is_core = MEI
			NOT = {
				is_core = THU
			}
		}
		current_age = age_of_discovery
	}

	immediate = {
		set_country_flag = sax_thuringen_split_to_happen
	}

	option = { # Choose Thuringia.
		name = ipe_flavor_sax.4.a
		ai_chance = {
			factor = 75
		}
		custom_tooltip = ipe_flavor_sax.4.a.tooltip
		hidden_effect = {
			random_list = {
				75 = {
					country_event = {
						id = ipeSAX.1
					}
				}
				25 = {
					country_event = {
						id = ipeSAX.2
					}
				}
			}
		}
	}

	option = { # Choose Meissen.
		name = ipe_flavor_sax.4.b
		ai_chance = {
			factor = 25
		}
		custom_tooltip = ipe_flavor_sax.4.b.tooltip
		hidden_effect = {
			random_list = {
				25 = {
					country_event = {
						id = ipeSAX.3
					}
				}
				75 = {
					country_event = {
						id = ipeSAX.4
					}
				}
			}
		}
	}
}

#Altenburger Prinzenraub - Plot Fails
country_event = {
	id = flavor_sax.6
	title = flavor_sax.6.name
	desc = flavor_sax.6.desc
	picture = FORT_eventPicture

	fire_only_once = yes

	mean_time_to_happen = {
		years = 5
	}

	trigger = {
		tag = SAX
		is_at_war = no
		dynasty = "von Wettin"
		has_country_flag = sax_provoked_wilhelm_bad
		NOT = {
			had_country_flag = {
				flag = sax_provoked_wilhelm_bad
				days = 10950
			}
		}
	}

	option = {
		name = flavor_sax.6.A
		add_prestige = -25
	}
	option = {
		name = flavor_sax.6.B
		add_stability = -1
	}
}

#Altenburger Prinzenraub - Plot Succeeds
country_event = {
	id = flavor_sax.7
	title = flavor_sax.7.name
	desc = flavor_sax.7.desc
	picture = CIVIL_WAR_eventPicture

	fire_only_once = yes

	mean_time_to_happen = {
		years = 5
	}

	trigger = {
		tag = SAX
		is_at_war = no
		dynasty = "von Wettin"
		has_country_flag = sax_provoked_wilhelm_worse
		NOT = {
			had_country_flag = {
				flag = sax_provoked_wilhelm_worse
				days = 10950
			}
		}
	}

	immediate = {
		hidden_effect = {
			random_neighbor_country = {
				save_event_target_as = neighbour
			}
			random_neighbor_country = {
				limit = {
					OR = {
						is_rival = root
						is_enemy = root
					}
				}
				save_event_target_as = neighbour
			}
			random_neighbor_country = {
				limit = {
					tag = BOH
					NOT = { alliance_with = root }
					NOT = { is_subject_of = root }
					NOT = { overlord_of = root }
				}
				save_event_target_as = neighbour
			}
		}
	}

	option = {
		name = flavor_sax.7.A

		add_treasury = -200

		ai_chance = {
			factor = 2
			modifier = {
				factor = 0
				AND = {
					NOT = { treasury = 150 }
					num_of_loans = 5
				}
			}
			modifier = {
				factor = 0.5
				AND = {
					NOT = { treasury = 200 }
					num_of_loans = 1
				}
			}
			modifier = {
				factor = 2
				treasury = 250
			}
		}
	}
	option = {
		name = flavor_sax.7.B

		kill_heir = { allow_new_heir = no }
		add_ruler_modifier = {
			name = sax_grieving_death_of_sons
			duration = -1
		}

		ai_chance = {
			factor = 1
		}
	}
}


#The Treaty of Leipzig
country_event = {
	id = flavor_sax.8
	title = flavor_sax.8.name
	desc = flavor_sax.8.desc
	picture = DIPLOMACY_eventPicture

	is_triggered_only = yes

	trigger = {
		tag = SAX
		dynasty = "von Wettin"
		has_country_flag = sax_thuringen_split_to_happen
		government = monarchy
		NOT = {
			exists = THU
		}
		any_owned_province = {
			is_core = THU
			NOT = {
				is_capital_of = ROOT
			}
		}
		has_regency = no
	}

	immediate = {
		hidden_effect = {
			clr_country_flag = sax_thuringen_split_to_happen
		}
	}

	option = {
		name = flavor_sax.8.A
		
		release = THU
		elector = no
		THU = {
			define_ruler = {
				name = "Ernst"
				dynasty = "von Wettin"
				age = 30
				dip = 2
				adm = 2
				mil = 2
			}
			elector = yes
		}
		hidden_effect = {
			THU = {
				change_religion = ROOT
				capital_scope = {
					build_to_forcelimit = {
						infantry = 1
					}
				}
				change_government = monarchy
				adopt_reform_progress = ROOT
			}
		}
		if = {
			limit = {
				THU = {
					owns = 6950
				}
			}
			6950 = {
				cede_province = ROOT
			}
		}
		if = {
			limit = {
				THU = {
					owns = 3967
				}
			}
			3967 = {
				cede_province = ROOT
			}
		}
		if = {
			limit = {
				owns = 59
			}
			59 = {
				cede_province = THU
				add_core = THU
			}
		}
		if = {
			limit = {
				owns = 6948
			}
			6948 = {
				cede_province = THU
				add_core = THU
			}
		}
		hidden_effect = {
			THU = {
				every_owned_province = {
					remove_core = ROOT
				}
			}
		}

		ai_chance = {
			factor = 1
		}
	}
	option = {
		name = flavor_sax.8.B
		
		add_legitimacy = -60
		add_ruler_modifier = {
			name = sax_really_bad_reputation
			duration = -1
		}

		ai_chance = {
			factor = 1
		}
	}
	option = { # Play as Thuringia.
		name = ipe_flavor_sax.8.c
		switch_tag = THU

		hidden_effect = {
			release = THU
			THU = {
				define_ruler = {
					name = "Ernst"
					dynasty = "von Wettin"
					age = 30
					dip = 2
					adm = 2
					mil = 2
				}
				change_religion = ROOT
				capital_scope = {
					build_to_forcelimit = {
						infantry = 1
					}
				}
				change_government = monarchy
				adopt_reform_progress = ROOT
			}
			if = {
				limit = {
					THU = {
						owns = 6950
					}
				}
				6950 = {
					cede_province = ROOT
				}
			}
			if = {
				limit = {
					THU = {
						owns = 3967
					}
				}
				3967 = {
					cede_province = ROOT
				}
			}
			if = {
				limit = {
					owns = 59
				}
				59 = {
					cede_province = THU
					add_core = THU
				}
			}
			if = {
				limit = {
					owns = 6948
				}
				6948 = {
					cede_province = THU
					add_core = THU
				}
			}
			THU = {
				every_owned_province = {
					remove_core = ROOT
				}
			}
		}

		ai_chance = {
			factor = 0
		}
	}
}