###########################################
# Events for Russian Principalities
# Written by Henrik Lohmander
###########################################

namespace = russian_principality_events

#Agricultural Intensification

country_event = {
	id = russian_principality_events.2
	title = russian_principality_events.2.t
	desc = russian_principality_events.2.d
	picture = PEASANTS_ON_STEPPES_eventPicture

	trigger = {
		has_dlc = "Third Rome"
		has_reform = principality
		num_of_cities = 2
	}
	
	is_triggered_only = yes
	
	immediate = {
		hidden_effect = {
			random_owned_province = {
				limit = {
					is_capital = no
				}
				save_event_target_as = agricultural_intensification_province
			}
			random_owned_province = {
				limit = {
					is_capital = no
					NOT = { development = 15 }
				}
				save_event_target_as = agricultural_intensification_province
			}
			random_owned_province = {
				limit = {
					is_capital = no
					NOT = { development = 10 }
				}
				save_event_target_as = agricultural_intensification_province
			}
		}
	}

	mean_time_to_happen = {
		days = 1
	}

	option = {
		name = russian_principality_events.2.a #
		event_target:agricultural_intensification_province = {
			add_province_modifier = {
				name = encouraged_growth_production
				duration = 18250
			}
		}
	}
}

country_event = {
	id = russian_principality_events.3
	title = russian_principality_events.3.t
	desc = russian_principality_events.3.d
	picture = PRINCE_AND_BOYARS_eventPicture

	trigger = {
		has_dlc = "Third Rome"
		OR = {
			has_reform = principality
			has_reform = tsardom
		}
		num_of_cities = 5
		is_subject = no #Includes being a tributary
	}
	
	is_triggered_only = yes
	
	mean_time_to_happen = {
		days = 1
	}

	option = {
		name = russian_principality_events.3.a #Let us grant more land to the Boyars.
		add_government_power = {
			government_mechanic = russian_mechanic
			which = ADM
			amount = 35
		}
	}
	option = {
		name = russian_principality_events.3.b #We do not need the Boyar's for this.
		add_government_power = {
			government_mechanic = russian_mechanic
			which = MIL
			amount = 35
		}
	}
}

#Land Acquisition

country_event = {
	id = russian_principality_events.4
	title = russian_principality_events.4.t
	desc = russian_principality_events.4.d
	picture = PEASANTS_ON_STEPPES_eventPicture

	trigger = {
		has_dlc = "Third Rome"
		OR = {
			has_reform = principality
			AND = {
				has_reform = tsardom
				NOT = { num_of_cities = 40 }
			}
		}
		num_of_cities = 5
		is_subject = no #Includes being a tributary
		any_owned_province = {
			is_capital = no
			has_owner_culture = yes
		}
	}
	
	immediate = {
		hidden_effect = {
			random_list = {
				33 = { set_country_flag = land_tax }
				33 = { set_country_flag = land_production }
				33 = { set_country_flag = land_manpower }
			}
		}
	}
	
	is_triggered_only = yes
	
	mean_time_to_happen = {
		days = 1
	}

	option = {
		name = russian_principality_events.4.a #"Land is true wealth."
		trigger_switch = {
			on_trigger = has_country_flag
			land_tax = {
				clr_country_flag = land_tax
				random_owned_province = {
					limit = {
						is_capital = no
						has_owner_culture = yes
					}
					add_province_modifier = {
						name = encouraged_growth_tax
						duration = 18250
					}
				}
			}
			land_production = {
				clr_country_flag = land_production
				random_owned_province = {
					limit = {
						is_capital = no
						has_owner_culture = yes
					}
					add_province_modifier = {
						name = encouraged_growth_production
						duration = 18250
					}
				}
			}
			land_manpower = {
				clr_country_flag = land_manpower
				random_owned_province = {
					limit = {
						is_capital = no
						has_owner_culture = yes
					}
					add_province_modifier = {
						name = encouraged_growth_manpower
						duration = 18250
					}
				}
			}
		}
	}
	option = {
		name = russian_principality_events.4.b #"We need gold for the royal treasury."
		add_years_of_income = 0.15
	}
	option = {
		name = russian_principality_events.4.c #"We must use this as leverage in state affairs."
		trigger_switch = {
			on_trigger = has_country_flag
			land_tax = {
				clr_country_flag = land_tax
				add_government_power = {
					government_mechanic = russian_mechanic
					which = ADM
					amount = 35
				}
			}
			land_production = {
				clr_country_flag = land_production
				add_government_power = {
					government_mechanic = russian_mechanic
					which = DIP
					amount = 35
				}
			}
			land_manpower = {
				clr_country_flag = land_manpower
				add_government_power = {
					government_mechanic = russian_mechanic
					which = MIL
					amount = 35
				}
			}
		}
	}
}

#St George's day
country_event = {
	id = russian_principality_events.7
	title = russian_principality_events.7.t
	desc = russian_principality_events.7.d
	picture = PEASANTS_ON_STEPPES_eventPicture

	trigger = {
		has_dlc = "Third Rome"
		has_reform = principality
		any_owned_province = {
			NOT = { has_province_modifier = restricted_movement }
			is_capital = no
			is_colony = no
		}
	}
	
	immediate = {
		hidden_effect = {
			random_owned_province = {
				limit = {
					NOT = { has_province_modifier = restricted_movement }
					is_capital = no
					is_colony = no
				}
				save_event_target_as = serfdom_province
			}
			random_owned_province = {
				limit = {
					is_capital = no
					is_colony = no
					has_owner_culture = yes
					NOT = { has_province_modifier = restricted_movement }
				}
				save_event_target_as = serfdom_province
			}
			random_owned_province = {
				limit = {
					is_capital = no
					is_colony = no
					has_owner_culture = yes
					trade_goods = grain
					NOT = { has_province_modifier = restricted_movement }
				}
				save_event_target_as = serfdom_province
			}
			random_owned_province = {
				limit = {
					is_capital = no
					is_colony = no
					has_owner_culture = yes
					trade_goods = grain
					NOT = { has_province_modifier = restricted_movement }
				}
				save_event_target_as = serfdom_province
			}
			random_owned_province = {
				limit = {
					is_capital = no
					is_colony = no
					has_owner_culture = yes
					trade_goods = grain
					is_in_capital_area = yes
					NOT = { has_province_modifier = restricted_movement }
				}
				save_event_target_as = serfdom_province
			}
		}
	}
	
	is_triggered_only = yes
	
	mean_time_to_happen = {
		days = 1
	}

	option = {
		name = russian_principality_events.7.a #We will do as they ask.
		ai_chance = {
			factor = 50
		}
		add_government_power = {
			government_mechanic = russian_mechanic
			which = ADM
			amount = 25
		}
		event_target:serfdom_province = {
			area = {
				limit = {
					owned_by = ROOT
					NOT = { has_province_modifier = restricted_movement }
					is_capital = no
					is_colony = no
				}
				add_province_modifier = {
					name = "restricted_movement"
					duration = 3650
				}
			}
		}
		add_estate_nobles_loyalty_effect = yes
		reduce_estate_burghers_loyalty_effect = yes
	}
	option = {
		name = russian_principality_events.7.b #We will not do as they ask.
		ai_chance = {
			factor = 50
		}
		add_stability_or_adm_power = yes
		event_target:serfdom_province = {
			area = {
				limit = {
					owned_by = ROOT
					NOT = { has_province_modifier = serfs_moving_away }
					is_capital = no
					is_colony = no
				}
				add_province_modifier = {
					name = "serfs_moving_away"
					duration = 3650
				}
			}
		}
		reduce_estate_nobles_loyalty_effect = yes
		add_estate_burghers_loyalty_effect = yes
	}
}

#Tartar Feudatories?
country_event = {
	id = russian_principality_events.9
	title = russian_principality_events.9.t
	desc = russian_principality_events.9.d
	picture = TRIBUTE_TO_TATARS_eventPicture

	trigger = {
		has_dlc = "Third Rome"
		has_reform = principality
		religion_group = christian
		num_of_cities = 5
		NOT = { has_country_modifier = tatar_feudatories }
		any_owned_province = {
			OR = {
				culture_group = kipchak
				religion_group = muslim
			}
			NOT = { has_province_flag = tatar_province_asked }
		}
	}
	
	immediate = {
		hidden_effect = {
			random_owned_province = {
				limit = {
					OR = {
						culture_group = kipchak
						religion_group = muslim
					}
					NOT = { has_province_flag = tatar_province_asked }
				}
				set_province_flag = tatar_province_asked
				save_event_target_as = tatar_province
			}
		}
	}

	is_triggered_only = yes
	
	mean_time_to_happen = {
		days = 1
	}

	option = {
		name = russian_principality_events.9.a #
		ai_chance = {
			factor = 25
			modifier = {
				factor = 0
				num_of_owned_provinces_with = {
					value = 10
					religion_group = muslim
				}
			}
		}
		reduce_estate_cossacks_loyalty_effect = yes
		reduce_estate_church_loyalty_effect = yes
		add_patriarch_authority = -0.05
		add_yearly_manpower = 1.5
		add_country_modifier = {
			name = "tatar_feudatories"
			duration = 5475
		}
		event_target:tatar_province = {
			if = {
				limit = {
					NOT = { religion_group = muslim }
				}
				change_religion = sunni
			}
			add_province_modifier = {
				name = "tatar_feudatory_province"
				duration = 5475
			}
		}
	}
	option = {
		name = russian_principality_events.9.b #
		ai_chance = {
			factor = 75
			modifier = {
				factor = 0
				NOT = {
					num_of_owned_provinces_with = {
						value = 5
						religion_group = muslim
					}
				}
			}
		}
		add_patriarch_authority = 0.05
		add_legitimacy = 5
	}
}


#The X Kremlin

country_event = {
	id = russian_principality_events.10
	title = russian_principality_events.10.t
	desc = russian_principality_events.10.d
	picture = KREMLIN_eventPicture

	trigger = {
		has_dlc = "Third Rome"
		has_reform = principality
		num_of_cities = 3
		capital_scope = {
			NOT = { has_province_modifier = tr_kremlin_improvements }
			fort_level = 2
		}
	}
	
	immediate = {
		hidden_effect = {
			capital_scope = {
				save_event_target_as = kremlin_here
			}
		}
	}
	
	is_triggered_only = yes
	
	mean_time_to_happen = {
		days = 1
	}

	option = {
		name = russian_principality_events.10.a #
		reduce_estate_nobles_loyalty_effect = yes
		add_yearly_manpower = -2.5
		add_prestige = 5
		event_target:kremlin_here = {
			add_province_modifier = {
				name = "tr_kremlin_improvements"
				duration = 3650
			}
		}
	}
	option = {
		name = russian_principality_events.10.b
		reduce_estate_burghers_loyalty_effect = yes
		add_government_power = {
			government_mechanic = russian_mechanic
			which = DIP
			amount = -35
		}
		add_prestige = 5
		event_target:kremlin_here = {
			add_province_modifier = {
				name = "tr_kremlin_improvements"
				duration = 3650
			}
		}
	}
	option = {
		name = russian_principality_events.10.c
		add_government_power = {
			government_mechanic = russian_mechanic
			which = ADM
			amount = -20
		}
		reduce_estate_church_loyalty_effect = yes
		add_patriarch_authority = -0.20
		add_prestige = 5
		event_target:kremlin_here = {
			add_province_modifier = {
				name = "tr_kremlin_improvements"
				duration = 3650
			}
		}
	}
	option = {
		name = russian_principality_events.10.dd
		add_prestige = -5
	}
}