namespace = new_time_of_troubles

# False Dmitry Overthrown
country_event = {
	id = new_time_of_troubles.1
	title = ipe_time_of_troubles.9.t
	desc = new_time_of_troubles.1.d
	picture = ANGRY_MOB_eventPicture

	is_triggered_only = yes

	option = { # They will pay for this.
		name = new_time_of_troubles.1.a
		tooltip = {
			FROM = {
				define_ruler = {
					name = "Vasiliy"
					dynasty = "Shuisky"
					adm = 0
					dip = 0
					mil = 0
					claim = 20
				}
			}
			add_opinion = {
				who = RUS
				modifier = rus_overthrow_dimitri
			}
		}
	}
}

# The Seven Boyars
country_event = {
	id = new_time_of_troubles.2
	title = new_time_of_troubles.2.t
	desc = new_time_of_troubles.2.d
	picture = ACCUSATION_eventPicture

	fire_only_once = yes

	major = yes

	trigger = {
		RUS = {
			has_ruler_flag = vasiliy_downfall
		}
		has_country_flag = supporter_of_dimitri
		religion_group = christian
		government = monarchy
		is_subject = no
		has_regency = no
		NOT = {
			war_with = RUS
		}
		RUS = {
			religion_group = christian
			government = monarchy
			is_subject = no
			is_neighbor_of = ROOT
		}
	}

	mean_time_to_happen = {
		months = 24
	}

	option = { # Let us accept this invitation.
		name = new_time_of_troubles.2.a
		ai_chance = {
			factor = 100
		}
		declare_war_with_cb = {
			who = RUS
			casus_belli = cb_fabricated_claims
		}
		hidden_effect = {
			RUS = {
				country_event = {
					id = new_time_of_troubles.3
				}
			}
		}
	}

	option = { # That throne is not ours to take.
		name = new_time_of_troubles.2.b
		ai_chance = {
			factor = 0
		}
		add_prestige = -10
	}
}

# The Seven Boyars
country_event = {
	id = new_time_of_troubles.3
	title = new_time_of_troubles.2.t
	desc = new_time_of_troubles.3.d
	picture = BATTLE_eventPicture

	is_triggered_only = yes

	immediate = {
		set_country_flag = seven_boyars_downfall
	}

	option = { # Even in these times, we will resist!
		name = new_time_of_troubles.3.a
		tooltip = {
			FROM = {
				declare_war_with_cb = {
					who = RUS
					casus_belli = cb_fabricated_claims
				}
			}
		}
		add_stability = -1
		add_government_power = {
			government_mechanic = russian_mechanic
			which = MIL
			amount = 100
		}
	}
}

# Heroes of Russia
country_event = {
	id = new_time_of_troubles.4
	title = new_time_of_troubles.4.t
	desc = new_time_of_troubles.4.d
	picture = BATTLE_eventPicture

	fire_only_once = yes

	trigger = {
		is_in_war = {
			casus_belli = cb_fabricated_claims
			defender_leader = ROOT
		}
	}

	mean_time_to_happen = {
		days = 30
	}

	option = { # Great heroes are needed to end the anarchy.
		name = new_time_of_troubles.4.a
		define_general = {
			name = "Dmitry Pozharski"
			fire = 2
			shock = 2
			manuever = 3
			siege = 1
		}
		add_country_modifier = {
			name = heroes_of_russia
			duration = 3650
		}
		add_yearly_manpower = 5
		add_stability_or_adm_power = yes
	}
}

# The Triumph of Dmitry
country_event = {
	id = new_time_of_troubles.5
	title = new_time_of_troubles.5.t
	desc = new_time_of_troubles.5.d
	picture = ANGRY_MOB_eventPicture

	is_triggered_only = yes

	option = { # We look forward to working with Dmitry.
		name = new_time_of_troubles.5.a
		tooltip = {
			add_truce_with = FROM
			FROM = {
				add_truce_with = ROOT
				define_ruler = {
					name = "Dmitry I"
					dynasty = "Rurik"
					adm = 0
					dip = 0
					mil = 0
					claim = 20
				}
				add_ruler_modifier = {
					name = usurper_on_the_throne
				}
			}
		}
	}
}

# The Romanov Dynasty
country_event = {
	id = new_time_of_troubles.6
	title = new_time_of_troubles.6.t
	desc = new_time_of_troubles.6.d
	picture = ANGRY_MOB_eventPicture

	fire_only_once = yes

	trigger = {
		has_ruler_flag = vasiliy_downfall
		has_global_flag = romanov_election
	}

	mean_time_to_happen = {
		months = 24
	}

	option = { # We welcome the Romanov dynasty.
		name = new_time_of_troubles.6.a
		clr_global_flag = romanov_election
		if = {
			limit = {
				has_heir = yes
			}
			remove_heir = {}
		}
		define_ruler = {
			name = "Mikhail"
			dynasty = "Romanov"
			adm = 4
			dip = 2
			mil = 3
			claim = 80
		}
		hidden_effect = {
			add_ruler_personality = kind_hearted_personality
		}
		add_stability_or_adm_power = yes
	}
}