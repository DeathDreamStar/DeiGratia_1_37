########################################
# Flavor Events for Wallachia
#
# Scripted by Sara Wendel-Örtqvist
########################################

namespace = flavor_wal
normal_or_historical_nations = yes

# Vlad the Impaler!
country_event = {
	id = flavor_wal.1
	title = "flavor_wal.EVTNAME1"
	desc = "flavor_wal.EVTDESC1"
	picture = IMPALED_SOLDIERS_eventPicture
	
	fire_only_once = yes
	
	trigger = {
		tag = WAL
		NOT = { is_year = 1477 }
		has_country_flag = wallachia_subjugated
		OR = {
			is_subject_of = HUN
			is_subject_of = TUR
		}
	}

	mean_time_to_happen = {
		months = 12
	}
	
	option = {
		name = "flavor_wal.EVTOPTA1"
		hidden_effect = {
			overlord = {
				country_event = {
					id = ipeWAL.7
				}
			}
		}
		if = {
			limit = {
				has_heir = yes
			}
			kill_heir = {}
		}
		define_ruler = {
			name = "Vlad Tepes"
			dynasty = "Draculesti"
			adm = 1
			dip = 0
			mil = 5
			age = 23
		}
		# define_ruler_to_general = {
		#	fire = 3
		#	shock = 4
		#	manuever = 4
		#	siege = 0
		# }
		if = {
			limit = {
				has_states_general_mechanic = yes
			}
			change_statists_vs_orangists = 1
		}
		if = {
			limit = {
				has_dlc = "Rights of Man" 
			}
			hidden_effect = { add_ruler_personality = cruel_personality }
		}
		add_adm_power = 50
		grant_independence = yes
		TUR = {
			add_opinion = {
				who = ROOT
				modifier = opinion_displeased
				years = 50
			}
		}
		HUN = {
			add_opinion = {
				who = ROOT
				modifier = opinion_displeased
				years = 50
			}
		}
		clr_country_flag = wallachia_subjugated
	}
}

# The Impalement of the Sultan (alt history)
# By Daniel Tolman

country_event = {
	id = flavor_wal.2
	title = "flavor_wal.EVTNAME2"
	desc = {
		trigger = {
			has_regency = no
			TUR = {
				has_regency = no
				has_heir = yes
			}
		}
		desc = "flavor_wal.EVTDESC2"
	}
	desc = {
		trigger = {
			has_regency = no
			TUR = {
				has_regency = no
				has_heir = no
			}
		}
		desc = "flavor_wal.EVTDESC2B"
	}
	desc = {
		trigger = {
			has_regency = yes
			TUR = {
				has_regency = no
				has_heir = yes
			}
		}
		desc = "flavor_wal.EVTDESC2C"
	}
	desc = {
		trigger = {
			has_regency = no
			TUR = {
				has_regency = yes
				has_heir = no
			}
		}
		desc = "flavor_wal.EVTDESC2D"
	}
	desc = {
		trigger = {
			has_regency = no
			TUR = {
				has_regency = yes
				has_heir = yes
			}
		}
		desc = "flavor_wal.EVTDESC2E"
	}
	desc = {
		trigger = {
			has_regency = yes
			TUR = {
				has_regency = yes
				has_heir = yes
			}
		}
		desc = "flavor_wal.EVTDESC2F"
	}
	desc = {
		trigger = {
			has_regency = yes
			TUR = {
				has_regency = no
				has_heir = no
			}
		}
		desc = "flavor_wal.EVTDESC2G"
	}
	desc = {
		trigger = {
			has_regency = yes
			TUR = {
				has_regency = yes
				has_heir = no
			}
		}
		desc = "flavor_wal.EVTDESC2H"
	}
	picture = IMPALED_SOLDIERS_eventPicture
	
	fire_only_once = yes
	
	is_triggered_only = yes
	
	option = {
		name = "flavor_wal.EVTOPTA2"
		TUR = {
			tooltip = {
				if = {
					limit = {
						has_regency = no
					}
					kill_ruler = yes
				}
				if = {
					limit = {
						has_heir = yes
					}
					kill_heir = {}
				}
				if = {
					limit = {
						has_consort = yes
					}
					remove_consort = yes
				}
				add_opinion = {
					who = ROOT
					modifier = sultan_impaled_opinion
				}
			}
			every_rival_country = {
				limit = {
					NOT = {
						tag = PAP
					}
				}
				add_opinion = {
					who = ROOT
					modifier = impaled_the_sultan_opinion
				}
			}
			hidden_effect = {
				country_event = {
					id = flavor_wal.3
					days = 1
				}
			}
		}
		PAP = {
			add_opinion = {
				who = ROOT
				modifier = impaled_the_sultan_opinion
			}
		}
	}
}

# For Ottomans
country_event = {
	id = flavor_wal.3
	title = "flavor_wal.EVTNAME3"
	desc = "flavor_wal.EVTDESC3"
	picture = IMPALED_SOLDIERS_eventPicture
	
	fire_only_once = yes
	
	is_triggered_only = yes
	
	mean_time_to_happen = {
		days = 1
	}
	
	option = {
		name = "flavor_wal.EVTOPTA3"
		if = {
			limit = {
				has_consort = yes
			}
			remove_consort = yes
		}
		if = {
			limit = {
				has_regency = no
			}
			kill_ruler = yes
		}
		if = {
			limit = {
				has_heir = yes
			}
			kill_heir = { allow_new_heir = no }
		}		
		add_opinion = {
			who = FROM
			modifier = sultan_impaled_opinion
		}
	}
}
